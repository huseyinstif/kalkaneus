id: directory-listing

info:
  name: Directory Listing Enabled
  author: Kalkaneus Team
  severity: low
  description: Detects directories with listing enabled
  reference:
    - https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/04-Review_Old_Backup_and_Unreferenced_Files_for_Sensitive_Information
  tags: exposure,directory-listing,misconfiguration

http:
  - method: GET
    path:
      - "{{BaseURL}}/uploads/"
      - "{{BaseURL}}/images/"
      - "{{BaseURL}}/files/"
      - "{{BaseURL}}/backup/"
      - "{{BaseURL}}/admin/"
      - "{{BaseURL}}/temp/"
      - "{{BaseURL}}/tmp/"
    
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "Index of /"
          - "Directory listing for"
          - "Parent Directory"
        condition: or
        
      - type: status
        status:
          - 200
